# git_guide.md

## Инструкция по работе с GitHub API для LLM

Этот документ содержит критические требования и best practices для работы с GitHub API через MCP tools, основанные на практическом опыте и типичных ошибках.

---

## Критические требования

### 1. ВСЕГДА получать актуальный SHA перед обновлением файла

**Проблема:**
```
Error: 409 file.md does not match {old_sha}
```

**Причина:**
- Файл был изменён между получением SHA и попыткой обновления
- Используется устаревший SHA из предыдущей операции

**Решение:**
- Вызвать `get_file_contents()` непосредственно перед `create_or_update_file()`
- Использовать SHA из ответа API, не из памяти
- Минимизировать задержку между получением SHA и обновлением
- При ошибке 409 - повторить с актуальным SHA

---

### 2. НИКОГДА не использовать заглушки в поле content

**Проблема:**
Передача буквального текста "... (далее полный текст)" или комментариев вместо реального содержания.

**Результат:** Файл содержит placeholder вместо фактического текста.

**Решение:** Только полный, детализированный текст в content.

---

### 3. Обязательная проверка SHA для операций update

**Проблема:**
```
Error: "sha" wasn't supplied
```

**Причина:** Попытка обновить существующий файл без указания SHA.

**Решение:**
- Перед update всегда получать SHA через `get_file_contents()`.
- Для новых файлов указывать `sha=""`.

---

### 4. Полнота содержимого: валидация

**Проблема:** Файл содержит только заголовки или placeholder-текст.

**Решение:**
- Проверить, что вся секция заполнена детализированным контентом.
- Убедиться в отсутствии фраз типа "...", "(далее)", "TODO", "PLACEHOLDER".
- Проверить ожидаемый размер файла.

---

## Workflow для LLM

1. Проверить `len(content)` (ожидаемый минимум -- 10,000+ байт для крупных артефактов)
2. Вызвать `get_file_contents(path)` → получить SHA
3. Передать полный текст, никаких заглушек
4. Внести SHA в вызов `create_or_update_file`
5. После коммита проверить размер результата через API
6. Если размер не совпадает с ожиданием, исправить контент и повторить

---

## Чек-лист для загрузки файла
- [ ] Контент полный, без placeholder, "...", "(далее)"
- [ ] Размер контента соответствует ожиданиям
- [ ] SHA получен непосредственно перед upload
- [ ] SHA корректно передан для update
- [ ] После загрузки сверить размер через API

---

## Примеры типичных ошибок и решений
- SHA рассинхронизирован → получить заново
- Контент содержит "..." → заменить на реальный текст
- SHA отсутствует при обновлении → указать из get_file_contents
- Размер после загрузки < 90% исходного → повторить upload с полным содержимым

---

## Summary: Золотые правила
1. Всегда получать и использовать актуальный SHA
2. Содержимое должно быть 100% real без заглушек/placeholder/"..."
3. После загрузки проверить объем и структуру
4. Не использовать переменные или комментарии вместо текста файла
5. При ошибке 409 повторить upload с новым SHA

---

**Версия:** 1.0  
**Дата:** 23 ноября 2025  
**Статус:** Production-ready
